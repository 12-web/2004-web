import{r as p,j as s,b as ge,a as k,e as ye,f as Ie,g as y,h as Fe,c as J,u as ne,o as de,i as _e,k as ze,l as Pe}from"./index-CSqFwPM3.js";import{T as W,L as j}from"./Layout-CxlruPxc.js";import{B as Oe,C as Re,D as qe,m as L,u as He,I as ve,c as We,G as z,s as P,a as X,R as I,b as se,d as $e,e as Be,M as De,f as Ge,U as Me,t as Qe,g as Je,h as Ke}from"./toBase64-DMcPn46T.js";import{R as Ze,I as Xe,C as es,T as xe,H as h,S as je,D as H,g as ss,a as Ne,b as ns,A as as}from"./Alert-BrohWNuD.js";import{f as M,r as fe,a as O,B as os,u as Te,w as rs,T as ts,b as E,m as C,D as le,I as me,c as is,d as ae,e as ls,g as he,F as we}from"./useToast-DH1UudK5.js";import{B as S}from"./MixSpace-D0mpTH-n.js";import{T as ms}from"./TextField-be9RhR2T.js";import{I as pe,L as ds}from"./LayoutContainer-BzmHpDds.js";import{o as cs}from"./organizationApi-BJ25WP-4.js";import"./createResponsesImage-CHienvk_.js";const us=({asnList:e,...a})=>{const{accessor:n,openedFilter:d}=a,c=p.useMemo(()=>e.map(l=>{let m;return n&&(n==="creationDate"||n==="shipmentDate"?m=M(l[n]):m=l[n]),{name:m||"(Пусто)",value:n?l[n].toString():""}}),[e]);return s.jsxDEV(Ze,{isOpen:d===n,checkboxes:c,...a},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/RowSetter/RowSetter.tsx",lineNumber:35,columnNumber:10},void 0)},bs=({status:e})=>{const a=p.useMemo(()=>{switch(!0){case e==="Присвоен номер":return"#D1D2DE";case e==="Заполняется":return"#F5222D";case e==="Все строки обработаны":return"#FADB14";case e==="Обработка завершена":return"#52C41A";case e==="Новый":return"#2fc2eb";default:return"#D1D2DE"}},[e]);return s.jsxDEV(s.Fragment,{children:[e!=="-"&&s.jsxDEV(Oe,{style:{boxShadow:`inset 0 0 0 var(--badge-size) ${a}`,flexShrink:0},minified:!0,size:"s"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/IncomingState/IncomingState.tsx",lineNumber:30,columnNumber:9},void 0),s.jsxDEV(W,{size:"s",lineHeight:"s",children:e},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/IncomingState/IncomingState.tsx",lineNumber:39,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/IncomingState/IncomingState.tsx",lineNumber:28,columnNumber:5},void 0)},Ae=e=>({asnId:e.AsnId,no:e.No,extNo:e.ExtNo,comment:e.Comment,incomingNo:e.IncomingNo,incomingState:(e==null?void 0:e.IncomingState)||"Новый",client:{label:e.Supplier.Name,id:e.Supplier.ClientId,code:e.Supplier.Code},clientId:e.Supplier.ClientId,clientLabel:e.Supplier.Name,clientCode:e.Supplier.Code,warehouse:{label:e.WarehouseFrom.Name,id:e.WarehouseFrom.WarehouseId,code:e.WarehouseFrom.Code,shippingWarehouse:0},organization:{label:e.VendorFrom.Name,id:e.VendorFrom.ClientId,code:e.VendorFrom.Code,shippingWarehouse:0},operator:e.Operator,creationDate:fe(e.Date),shipmentDate:fe(e.ExpectedIncomeDate),editable:e.Editable,removal:e.IncomingState==="Присвоен номер"||!e.IncomingNo}),Q=ge.injectEndpoints({endpoints:e=>({getAsnById:e.query({query:()=>({url:"",method:"GET",params:{command:k.GET_ASN,json:JSON.stringify({DateFrom:O(new Date("01/01/1991")),DateTo:O(new Date)}),emelClass:"API3PL"}}),transformResponse:({Asn:a,Error:n},d,{AsnId:c})=>{const l=a==null?void 0:a.find(m=>(m==null?void 0:m.AsnId)==c);return{Asn:l?Ae(l):void 0,Error:n}},providesTags:["ASN"]}),getAsn:e.query({query:a=>({url:"",method:"GET",params:{command:k.GET_ASN,json:JSON.stringify(a),emelClass:"API3PL"}}),transformResponse:({Asn:a,Error:n})=>({Asn:a==null?void 0:a.map(Ae),Error:n}),providesTags:["ASN"]}),postAsn:e.mutation({query:a=>({url:"",method:"POST",params:{command:k.POST_ASN,json:JSON.stringify(a),emelClass:"API3PL"}}),invalidatesTags:["ASN"]}),putAsn:e.mutation({query:a=>({url:"",method:"POST",params:{command:k.PUT_ASN,json:JSON.stringify(a),emelClass:"API3PL"}}),invalidatesTags:["ASN"]}),deleteAsn:e.mutation({query:a=>({url:"",method:"POST",params:{command:k.DELETE_ASN,json:JSON.stringify(a),emelClass:"API3PL"}}),invalidatesTags:["ASN"]}),uploadAsn:e.mutation({query:a=>({url:"",method:"POST",params:{command:k.UPLOAD_ASN,emelClass:"API3PL"},body:{TockenId:ye.getState().authUser.token,FileEncode:"1251",...a}}),invalidatesTags:["ORDER"]})})}),gs=()=>{const e=Ie(),a=n=>e(Fe({columns:n}));return s.jsxDEV(Re,{onSetTableCols:a,cols:Object.values(y).filter(n=>n.title)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/ColumnsSetter/ColumnsSetter.tsx",lineNumber:15,columnNumber:5},void 0)},ps="_toolbar_9uf6u_1",Ns="_buttons_group_9uf6u_8",fs="_buttons_9uf6u_8",ee={toolbar:ps,buttons_group:Ns,buttons:fs},As=({onResetFilters:e,startDate:a,endDate:n,search:d,setSearch:c,...l})=>{const m=J(),v=i=>m(de(i)),u=ne(i=>i.asnTableState),N=i=>{console.log(u)},A=[{label:"EXCEL",handleClick:N},{label:"PDF",handleClick:N}];return s.jsxDEV(j,{className:ee.toolbar,direction:"column",children:[s.jsxDEV(j,{className:ee.filter_group,children:[s.jsxDEV(qe,{startDate:a,endDate:n,...l},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:53,columnNumber:9},void 0),s.jsxDEV(j,{children:s.jsxDEV(ms,{className:ee.search,placeholder:"Найти заказ по номеру",rightSide:Xe,value:d,type:"text",size:"s",onChange:c},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:55,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:54,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:52,columnNumber:7},void 0),s.jsxDEV(j,{className:ee.buttons_group,children:[s.jsxDEV(j,{children:s.jsxDEV(S,{className:"button",label:"Новый ASN",size:"s",view:"secondary",iconLeft:pe,onClick:()=>v(L.ADD_ASN_MODAL_ID)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:68,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:67,columnNumber:9},void 0),s.jsxDEV(j,{className:ee.buttons,children:[s.jsxDEV(S,{onClick:e,className:"button",label:"Очистить все фильтры",size:"s",view:"secondary"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:78,columnNumber:11},void 0),s.jsxDEV(gs,{},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:85,columnNumber:11},void 0),s.jsxDEV(S,{className:"button",label:"Импорт из файла",size:"s",view:"secondary",onClick:()=>v(L.IMPORT_ASN)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:86,columnNumber:11},void 0),s.jsxDEV(os,{buttonName:"Экспорт таблицы",btns:A},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:93,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:77,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:66,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTableHandles/AsnTableHandles.tsx",lineNumber:51,columnNumber:5},void 0)},Ps="_table_xedfn_1",vs="_cell_xedfn_19",Ds="_cellButton_xedfn_24",xs="_switchButton_xedfn_31",js="_noData_xedfn_35",Ts="_pagination_xedfn_42",Y={table:Ps,cell:vs,cellButton:Ds,switchButton:xs,noData:js,pagination:Ts},hs=({onEditAsn:e})=>{const a=He(),[n,d]=p.useState(null),c=J(),{data:l,isLoading:m}=Q.useGetAsnQuery({DateFrom:O(a.startDate)||"",DateTo:O(a.endDate)||""}),v=p.useMemo(()=>{var f;return((f=l==null?void 0:l.Asn)==null?void 0:f.filter(t=>t.no.toLowerCase().startsWith((n==null?void 0:n.toLowerCase())||"")))||[]},[n,l]),{columns:u}=ne(f=>f.asnTableState),N=f=>{c(ze({asn:f})),c(de(L.DELETE_ASN_MODAL_ID))},A=p.useMemo(()=>[{...y.no,minWidth:180,renderCell:({row:t})=>s.jsxDEV(H,{style:{cursor:"pointer"},className:Y.cell,onClick:()=>e(t),children:s.jsxDEV(W,{size:"s",view:"brand",children:t.no?t.no:"-"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:71,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:67,columnNumber:11},void 0)},{...y.creationDate,minWidth:180,renderCell:({row:t})=>s.jsxDEV(H,{className:Y.cell,children:s.jsxDEV(W,{size:"s",children:t.creationDate?M(t.creationDate):"-"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:82,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:81,columnNumber:11},void 0)},{...y.shipmentDate,minWidth:180,renderCell:({row:t})=>s.jsxDEV(H,{className:Y.cell,children:s.jsxDEV(W,{size:"s",children:t.shipmentDate?M(t.shipmentDate):"-"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:91,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:90,columnNumber:11},void 0)},{...y.incomingState,minWidth:180,renderCell:({row:t})=>s.jsxDEV(H,{className:Y.cell,children:s.jsxDEV(bs,{status:t.incomingState?t.incomingState:"-"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:99,columnNumber:11},void 0)},{...y.incomingNo,minWidth:180,renderCell:({row:t})=>s.jsxDEV(H,{className:Y.cell,children:s.jsxDEV(W,{size:"s",children:t.incomingNo?t.incomingNo:"-"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:109,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:108,columnNumber:11},void 0)},{...y.clientCode,minWidth:180,renderCell:({row:t})=>s.jsxDEV(H,{className:Y.cell,children:s.jsxDEV(W,{size:"s",children:t.clientCode?t.clientCode:"-"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:118,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:117,columnNumber:11},void 0)},{...y.clientLabel,minWidth:180,renderCell:({row:t})=>s.jsxDEV(H,{className:Y.cell,children:s.jsxDEV(W,{size:"s",children:t.clientLabel?t.clientLabel:"-"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:127,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:126,columnNumber:11},void 0)},{title:"",accessor:"removal",maxWidth:40,renderCell:({row:t})=>s.jsxDEV(H,{className:Y.cellButton,children:s.jsxDEV(S,{size:"s",view:"clear",iconRight:ve,onlyIcon:!0,onClick:()=>N(t),disabled:!t.removal},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:137,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:136,columnNumber:11},void 0),renderHeaderCell:h}].filter(({accessor:t})=>(u==null?void 0:u.some(T=>T.accessor===t))||y[t||""].isRequired),[u]),i=p.useCallback(f=>{c(_e(f))},[]);return s.jsxDEV(es,{onSetRows:i,data:v,isLoading:m,paginationClass:Y.pagination,children:({paginatedData:f,sortColumn:t,handleSort:T,...F})=>s.jsxDEV(s.Fragment,{children:[s.jsxDEV(As,{...a,setSearch:d,search:n,onResetFilters:F.resetFilters},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:169,columnNumber:11},void 0),s.jsxDEV(j,{direction:"column",children:s.jsxDEV(xe,{className:Y.table,rows:f,stickyHeader:!0,headerZIndex:1,getRowKey:D=>D.asnId,columns:A.map(D=>({...D,renderHeaderCell:({tableRef:R,...U})=>s.jsxDEV(h,{isActive:D.accessor===t,controlRight:D.title?[s.jsxDEV(us,{accessor:D.accessor||Object.values(y)[0].accessor,asnList:v,...F},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:193,columnNumber:29},void 0)]:null,icon:D.title?s.jsxDEV(je,{isActive:D.accessor===t},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:203,columnNumber:25},void 0):void 0,onClick:()=>T(D.accessor||"asnId"),...U},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:188,columnNumber:19},void 0)}))},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:176,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:175,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:168,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnTable/AsnTable.tsx",lineNumber:162,columnNumber:5},void 0)},ws=e=>{const{GoodsItem:a,MU:n}=e;return{id:e.AsnLineId,good:{id:a.GoodItemId,article:a.Code,brutto:a.Brutto,height:a.Height,length:a.Length,label:a.Name,netto:a.Netto,width:a.Width},goodArticle:a.Code,goodLabel:a.Name,bbd:e.BBD,comment:e.Comment,count:e.Count,lot:e.Lot,measurementUnit:{id:n.MuId,label:n.Name,extId:n.ExtMuId,extLabel:n.ExtName},status:"",stockStatus:e.StockStatus,MU:n.Name}},G=ge.injectEndpoints({endpoints:e=>({getAsnLines:e.query({query:a=>({url:"",method:"POST",params:{command:k.GET_ASN_LINES,json:JSON.stringify(a),emelClass:"API3PL"}}),transformResponse:({AsnLine:a,Error:n})=>({AsnLine:a==null?void 0:a.map(ws),Error:n}),providesTags:["ASN_LINE"]}),postAsnLine:e.mutation({query:a=>({url:"",method:"POST",params:{command:k.POST_ASN_LINE,json:JSON.stringify(a),emelClass:"API3PL"}}),invalidatesTags:["ASN_LINE"]}),putAsnLine:e.mutation({query:a=>({url:"",method:"POST",params:{command:k.PUT_ASN_LINE,json:JSON.stringify(a),emelClass:"API3PL"}}),invalidatesTags:["ASN_LINE"]}),deleteAsnLine:e.mutation({query:({id:a})=>({url:"",method:"POST",params:{command:k.DELETE_ASN_LINE,json:JSON.stringify({AsnLineId:a}),emelClass:"API3PL"}}),invalidatesTags:["ASN_LINE"]})})}),Es=e=>({Asn:{No:e.no,ExtNo:e.extNo,Comment:e.comment,WarehouseFromId:e.warehouse.id,WarehouseToId:e.warehouse.id,SupplierId:e.client.id,VendorFromId:e.organization.id,VendorToId:e.organization.id,Editable:!0,ExpectedIncomeDate:O(new Date(e.shipmentDate))||""}}),ks=(e,a)=>({Asn:{AsnId:a,No:e.no,ExtNo:e.extNo,Comment:e.comment,WarehouseFromId:e.warehouse.id,WarehouseToId:e.warehouse.id,SupplierId:e.client.id,VendorFromId:e.organization.id,VendorToId:e.organization.id,Editable:!0,ExpectedIncomeDate:O(new Date(e.shipmentDate))||""}}),Ee=(e,a)=>({AsnLine:{AsnId:a,GoodsItemId:e.good.id,Count:parseInt(e.count),MuId:e.measurementUnit.id,StockStatus:"N",BBD:O(new Date(e.bbd))||"",Comment:e.comment,Lot:e.lot,ExtCount:0,RegLineRo:0,SsccCode:"",RegNoRo:""}}),Ss=(e,a,n)=>({AsnLine:{AsnLineId:n,AsnId:a,GoodsItemId:e.good.id,Count:parseInt(e.count),MuId:e.measurementUnit.id,StockStatus:"N",BBD:O(new Date(e.bbd))||"",Lot:e.lot,ExtCount:0,SsccCode:"",RegNoRo:"",RegLineRo:0,Comment:e.comment}}),Us=ge.injectEndpoints({endpoints:e=>({getSuppliers:e.query({query:()=>({url:"",params:{command:k.GET_SUPPLIERS,emelClass:"API3PL"}}),transformResponse:({ClientList:a,Error:n})=>({Suppliers:a==null?void 0:a.map(We),Error:n}),providesTags:["Suppliers"]}),postSupplier:e.mutation({query:a=>({url:"",method:"POST",params:{command:k.POST_CLIENT,emelClass:"API3PL",json:JSON.stringify(a)}}),invalidatesTags:["Suppliers"]})})}),ke=({isEditMode:e,isLoading:a})=>{const{register:n,setValue:d}=Te(),{data:c}=Us.useGetSuppliersQuery(),{data:l}=rs.useGetWarehousesQuery(),{data:m}=cs.useGetOrganizationQuery(),v=J(),u=()=>v(de(L.ADD_NEW_SUPPLIER));return s.jsxDEV(ts,{children:({step:N,steps:A})=>s.jsxDEV(s.Fragment,{children:[s.jsxDEV(z,{cols:2,colGap:"s",className:N===A[0]?void 0:P.hidden,children:[s.jsxDEV(X,{children:s.jsxDEV(z,{rowGap:"s",children:[s.jsxDEV(E,{registered:n("no",{required:C.required,setValueAs:i=>i.trim()}),readOnly:!e,required:e,type:"text",label:"ASN Номер",placeholder:"Введите номер ASN",size:"s",disabled:a},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:46,columnNumber:17},void 0),s.jsxDEV(X,{children:s.jsxDEV(z,{cols:2,yAlign:"top",gap:"s",children:[s.jsxDEV(I,{isReplacing:!e,label:"Поставщик",path:"client.label",children:s.jsxDEV(se,{items:(c==null?void 0:c.Suppliers)||[],registered:n("client",{required:C.required}),required:e,label:"Поставщик",onChange:i=>d("clientCode",(i==null?void 0:i.code)||""),size:"s",disabled:a,placeholder:"Выберите"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:65,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:61,columnNumber:21},void 0),s.jsxDEV(z,{cols:2,yAlign:"bottom",gap:"s",className:P.fieldWithBtn,children:[s.jsxDEV(E,{registered:n("clientCode"),readOnly:!0,type:"text",label:"Код",size:"s",placeholder:"Поставщик"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:77,columnNumber:23},void 0),s.jsxDEV(S,{disabled:!e||a,size:"s",view:"secondary",iconRight:pe,onlyIcon:!0,onClick:u},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:85,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:76,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:60,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:59,columnNumber:17},void 0),s.jsxDEV(X,{children:s.jsxDEV(z,{cols:2,yAlign:"top",gap:"s",children:[s.jsxDEV(I,{isReplacing:!e,label:"Организация",path:"organization.label",children:s.jsxDEV(se,{items:(m==null?void 0:m.Organizations)||[],registered:n("organization",{required:C.required}),required:e,label:"Организация",onChange:i=>d("organizationCode",(i==null?void 0:i.code)||""),size:"s",disabled:a,placeholder:"Выберите"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:102,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:98,columnNumber:21},void 0),s.jsxDEV(E,{registered:n("organizationCode"),readOnly:!0,type:"text",label:"Код",size:"s",placeholder:"Организация-собственник"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:113,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:97,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:96,columnNumber:17},void 0),s.jsxDEV(z,{cols:2,yAlign:"top",gap:"s",children:[s.jsxDEV(I,{label:"Склад",isReplacing:!e,path:"warehouse.label",children:s.jsxDEV(se,{items:(l==null?void 0:l.Warehouse)||[],registered:n("warehouse",{required:C.required}),required:e,label:"Склад",placeholder:"Выберите",onChange:i=>d("warehouseCode",(i==null?void 0:i.code)||""),size:"s",disabled:a},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:129,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:125,columnNumber:19},void 0),s.jsxDEV(E,{registered:n("warehouseCode"),readOnly:!0,type:"text",label:"Код",size:"s",placeholder:"Склад"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:140,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:44,columnNumber:13},void 0),s.jsxDEV(X,{children:s.jsxDEV(z,{rowGap:"s",children:[s.jsxDEV(E,{registered:n("operator",{required:C.required,setValueAs:i=>i.trim()}),readOnly:!e,required:e,type:"text",label:"Оператор",size:"s",disabled:a,placeholder:"Оператор"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:153,columnNumber:17},void 0),s.jsxDEV(E,{registered:n("incomingNo",{setValueAs:i=>i.trim()}),disabled:!0,type:"text",label:"Номер прихода",size:"s",placeholder:"Номер прихода"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:166,columnNumber:17},void 0),s.jsxDEV(E,{registered:n("extNo",{required:C.required,setValueAs:i=>i.trim()}),readOnly:!e,required:e,type:"text",label:"Внешний номер",placeholder:"Внешний номер",size:"s"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:176,columnNumber:17},void 0),s.jsxDEV(E,{registered:n("comment",{setValueAs:i=>i.trim()}),readOnly:!e,type:"textarea",label:"Комментарий",size:"s",placeholder:"Комментарий"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:188,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:152,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:151,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:43,columnNumber:11},void 0),s.jsxDEV(z,{cols:2,colGap:"s",className:N===A[1]?void 0:P.hidden,children:s.jsxDEV(X,{children:s.jsxDEV(z,{rowGap:"s",children:[s.jsxDEV(I,{isReplacing:!e,label:"Создан",path:"creationDate",valueModifier:M,children:s.jsxDEV(le,{registered:n("creationDate",{valueAsDate:!0}),readOnly:!0,required:e,rightSide:me,size:"s",label:"Создан",format:"dd/MM/yyyy",placeholder:"дд/мм/гггг",disabled:!0},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:207,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:202,columnNumber:17},void 0),s.jsxDEV(I,{label:"Ожидаемое время прибытия",isReplacing:!e,path:"shipmentDate",valueModifier:M,children:s.jsxDEV(le,{registered:n("shipmentDate",{required:C.required,valueAsDate:!0}),readOnly:!e,required:e,rightSide:me,size:"s",label:"Ожидаемое время прибытия",format:"dd/MM/yyyy",placeholder:"дд/мм/гггг"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:224,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:219,columnNumber:17},void 0),s.jsxDEV(I,{label:"Время фактического прихода",isReplacing:!e,path:"factDate",valueModifier:is,children:s.jsxDEV(le,{registered:n("factDate",{valueAsDate:!0}),readOnly:!e,rightSide:me,size:"s",label:"Время фактического прихода",format:"dd/MM/yyyy",placeholder:"дд/мм/гггг"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:243,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:238,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:201,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:200,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:199,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:42,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Tabs/Tabs.tsx",lineNumber:40,columnNumber:5},void 0)},Cs=[{label:"N - нормальный",id:"N"},{label:"B - брак",id:"B"},{label:"Q - карантин",id:"Q"},{label:"H - близок к просрочке",id:"H"},{label:"E - просрочен",id:"E"},{label:"K - входной контроль",id:"K"}],Se=({isEditMode:e,asnId:a,isLoading:n,onCancelEditMode:d})=>{const[c,l]=p.useState([]),[m,v]=p.useState([]),N=!!ne(o=>o.modalState).openedIds.find(o=>o===L.EDIT_ASN_MODAL_ID),{showToast:A}=ae(),{register:i,setValue:f,unregister:t,resetField:T,watch:F}=Te(),[D]=G.useLazyGetAsnLinesQuery(),[R]=$e.useLazyGetMeasurementUnitsQuery(),{data:U}=ss.useGetGoodsQuery(),$=p.useCallback(o=>{t("orderLines"),o.forEach(r=>{const{id:b}=r,x=Cs.find(ie=>ie.id===r.stockStatus);f(`asnLines[${b}].good`,r.good),f(`asnLines[${b}].goodArticle`,r.goodArticle),f(`asnLines[${b}].measurementUnit`,r.measurementUnit),f(`asnLines[${b}].count`,r.count),f(`asnLines[${b}].stockStatus`,x),f(`asnLines[${b}].lot`,r.lot),f(`asnLines[${b}].bbd`,ls(r.bbd)),f(`asnLines[${b}].comment`,r.comment)})},[N]),oe=p.useCallback(async()=>{if(a)try{const{AsnLine:o,Error:r}=await D({AsnId:a}).unwrap();r&&A(r),o&&(l(o),$(o))}catch{}},[N]);p.useEffect(()=>{N&&oe()},[N]);const re=()=>l([...c,{id:Date.now()}]),B=o=>{l(r=>r.filter(({id:b})=>b!==o)),t(`asnLines[${o}]`)},g=(o,r)=>{l(b=>b.map(x=>x.id===o?{...x,...r}:x))},_=p.useCallback(o=>s.jsxDEV(I,{isReplacing:!e,path:`asnLines[${o.row.id}].good.label`,rootClassName:P.lineCell,children:s.jsxDEV(se,{items:(U==null?void 0:U.Goods)||[],registered:i(`asnLines[${o.row.id}].good`,{required:C.required}),required:!0,size:"s",virtualScroll:!0,placeholder:"Выберите",disabled:!e||n,onChange:async r=>{if(f(`asnLines[${o.row.id}].goodArticle`,r==null?void 0:r.article),g(o.row.id,{goodLabel:r==null?void 0:r.label,goodArticle:r==null?void 0:r.article}),T(`asnLines[${o.row.id}].measurementUnit`),(r==null?void 0:r.id)!==void 0){const{data:b}=await R({GoodItemId:r==null?void 0:r.id});b!=null&&b.MU&&(f(`asnLines[${o.row.id}].measurementUnit`,b==null?void 0:b.MU[0]),g(o.row.id,{MU:b==null?void 0:b.MU[0].label}))}}},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:117,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:113,columnNumber:7},void 0),[U,e,n]),ce=p.useCallback(o=>s.jsxDEV(E,{registered:i(`asnLines[${o.row.id}].goodArticle`),readOnly:!0,size:"s",type:"textarea",className:P.lineCell,disabled:n},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:151,columnNumber:7},void 0),[e,n]),te=p.useCallback(o=>{const r=F(`asnLines[${o.row.id}].good`),[b,x,ie,ue]=Be(r);return s.jsxDEV(I,{isReplacing:!e,path:`asnLines[${o.row.id}].measurementUnit.label`,rootClassName:P.lineCell,children:s.jsxDEV(se,{registered:i(`asnLines[${o.row.id}].measurementUnit`,{required:C.required}),required:!0,placeholder:"Выберите",size:"s",onChange:be=>g(o.row.id,{MU:be==null?void 0:be.label}),virtualScroll:!0,isLoading:x,items:b,disabled:!e||ie||n,onDropdownOpen:ue},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:172,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:168,columnNumber:9},void 0)},[e,n]),V=p.useCallback(o=>s.jsxDEV(E,{registered:i(`asnLines[${o.row.id}].count`,{required:C.required,onChange:r=>g(o.row.id,{count:r.target.value})}),readOnly:!e,required:e,size:"s",className:P.lineCell,type:"textarea",disabled:n},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:193,columnNumber:7},void 0),[e,n]),q=p.useCallback(o=>s.jsxDEV(I,{isReplacing:!e,path:`asnLines[${o.row.id}].bbd`,rootClassName:P.lineCell,valueModifier:M,children:s.jsxDEV(le,{registered:i(`asnLines[${o.row.id}].bbd`,{required:C.required}),readOnly:!e,required:e,rightSide:me,size:"s",format:"dd/MM/yyyy",placeholder:"дд/мм/гггг",onChange:r=>g(o.row.id,{bbd:r==null?void 0:r.toString()}),disabled:n},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:238,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:233,columnNumber:7},void 0),[e,n]),K=p.useCallback(o=>s.jsxDEV(I,{isReplacing:!e,path:`asnLines[${o.row.id}].lot`,rootClassName:P.lineCell,children:s.jsxDEV(E,{registered:i(`asnLines[${o.row.id}].lot`,{setValueAs:r=>r.trim(),onChange:r=>g(o.row.id,{lot:r.target.value})}),size:"s",type:"textarea",disabled:n},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:259,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:255,columnNumber:7},void 0),[e,n]),Z=p.useCallback(o=>s.jsxDEV(E,{registered:i(`asnLines[${o.row.id}].comment`,{setValueAs:r=>r.trim(),onChange:r=>g(o.row.id,{comment:r.target.value})}),readOnly:!e,className:P.lineCell,size:"s",type:"textarea",disabled:n},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:275,columnNumber:7},void 0),[e,n]),w=p.useCallback(o=>s.jsxDEV("div",{className:P.lineCell,children:s.jsxDEV(S,{disabled:!e||n,size:"s",view:"clear",onClick:()=>B(o.row.id),iconLeft:ve,onlyIcon:!0},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:292,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:291,columnNumber:7},void 0),[B,e,n]),Ue=[{title:"",accessor:"select",renderCell:p.useCallback(o=>s.jsxDEV("div",{className:P.lineCell,children:s.jsxDEV(Ne,{disabled:!e||n,size:"s",checked:!!m.find(r=>o.row.id===r.id),view:"primary",onChange:()=>Ce(o.row)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:307,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:306,columnNumber:7},void 0),[m,e,n]),maxWidth:40,renderHeaderCell:h},{title:"Наименование",accessor:"goodLabel",renderCell:_,width:"auto",renderHeaderCell:h},{title:"Артикул",accessor:"goodArticle",renderCell:ce,maxWidth:120,renderHeaderCell:h},{title:"Кол-во",accessor:"count",renderCell:V,maxWidth:110,renderHeaderCell:h},{title:"ЕИ",accessor:"MU",renderCell:te,maxWidth:110,renderHeaderCell:h},{title:"BBD",accessor:"bbd",renderCell:q,maxWidth:110,renderHeaderCell:h},{title:"Партия",accessor:"lot",renderCell:K,maxWidth:110,renderHeaderCell:h},{title:"Коммент.",accessor:"comment",renderCell:Z,maxWidth:110,renderHeaderCell:h},{title:"",accessor:"actions",maxWidth:40,renderCell:w,renderHeaderCell:h}],Ce=o=>{const r=m.find(({id:b})=>b===o.id);v(r?m.filter(({id:b})=>b!==o.id):[...m,o])},Le=()=>{m.forEach(o=>{B(o.id)}),v([])},Ve=()=>{d==null||d(),oe()},Ye=()=>{m.length===c.length?v([]):v(c)};return s.jsxDEV(j,{direction:"column",className:P.innerFormWrapper,children:[e&&s.jsxDEV(j,{className:P.handles,children:[s.jsxDEV(S,{onClick:re,size:"s",label:"Новая строка",view:"secondary",iconLeft:pe,disabled:!e||n},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:424,columnNumber:11},void 0),d&&s.jsxDEV(S,{onClick:Ve,size:"s",label:"Отменить изменения",view:"secondary",disabled:!e||n},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:433,columnNumber:13},void 0),s.jsxDEV(S,{size:"s",label:"Удалить выбранные",view:"secondary",disabled:!e||!m.length||n,onClick:Le},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:442,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:423,columnNumber:9},void 0),s.jsxDEV(ns,{data:c,children:({sortedData:o,handleSort:r,sortColumn:b})=>s.jsxDEV(xe,{className:P.orderLineTable,rows:o,headerZIndex:0,columns:Ue.map(x=>({...x,renderHeaderCell:({tableRef:ie,...ue})=>x.accessor==="select"?s.jsxDEV(h,{onClick:Ye,className:P.checkboxHeader,controlLeft:s.jsxDEV(Ne,{size:"s",checked:!!m.length&&m.length===o.length,view:"primary",disabled:n},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:466,columnNumber:25},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:462,columnNumber:21},void 0):s.jsxDEV(h,{isActive:x.accessor===b,icon:x.title?s.jsxDEV(je,{isActive:b===x.accessor},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:485,columnNumber:25},void 0):void 0,onClick:()=>r(x.accessor||"good"),...ue},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:481,columnNumber:19},void 0)}))},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:453,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:451,columnNumber:7},void 0),c.length===0&&s.jsxDEV(W,{className:P.emptyTableText,align:"center",size:"s",children:"Нажмите “+ Новая строка” для добавления груза"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:497,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AsnLineTable/AsnLineTable.tsx",lineNumber:421,columnNumber:5},void 0)},Ls=e=>{const[a,n]=p.useState(!1),{showToast:d}=ae(),c=he(),{handleSubmit:l,reset:m,setValue:v}=c,u=J(),N=()=>u(Pe());p.useEffect(()=>{const t=O(new Date);t&&v("creationDate",t)},[]);const[A]=Q.usePostAsnMutation(),[i]=G.usePostAsnLineMutation(),f=async t=>{try{n(!0);const T=[],{AsnId:F,Error:D}=await A(Es(t)).unwrap();if(D&&T.push(D),F)for(let R in t.asnLines){const U=t.asnLines[R],{Error:$}=await i(Ee(U,F)).unwrap();$&&T.push($)}T.length?T.forEach(R=>d(R)):(m(),N())}catch{}finally{n(!1)}};return s.jsxDEV(we,{...c,children:s.jsxDEV("form",{onSubmit:l(f),className:P.form,children:[s.jsxDEV(j,{direction:"column",className:P.innerFormWrapper,children:[s.jsxDEV(ke,{isLoading:a,isEditMode:!0},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/Form/Form.tsx",lineNumber:74,columnNumber:11},void 0),s.jsxDEV(Se,{isLoading:a,isEditMode:!0},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/Form/Form.tsx",lineNumber:75,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/Form/Form.tsx",lineNumber:73,columnNumber:9},void 0),s.jsxDEV(j,{className:P.handles,children:s.jsxDEV(S,{label:"Сохранить",type:"submit",size:"s",loading:a},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/Form/Form.tsx",lineNumber:78,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/Form/Form.tsx",lineNumber:77,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/Form/Form.tsx",lineNumber:72,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/Form/Form.tsx",lineNumber:71,columnNumber:5},void 0)},Vs=()=>s.jsxDEV(De,{modalId:L.ADD_ASN_MODAL_ID,title:"Новый ASN",children:s.jsxDEV(Ls,{},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/AddAsn.tsx",lineNumber:8,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/AddAsn/AddAsn.tsx",lineNumber:7,columnNumber:5},void 0),Ys=({asnId:e})=>{var re,B;const[a,n]=p.useState(!1),[d,c]=p.useState(!1),l=()=>c(!d),m=he(),{handleSubmit:v,setValue:u,clearErrors:N}=m,{data:A,refetch:i}=Q.useGetAsnByIdQuery({AsnId:e}),[f]=Q.usePutAsnMutation(),[t]=G.useLazyGetAsnLinesQuery(),[T]=G.usePutAsnLineMutation(),[F]=G.usePostAsnLineMutation(),[D]=G.useDeleteAsnLineMutation(),{showToast:R}=ae(),U=p.useCallback(()=>{if(A!=null&&A.Asn){const g=A.Asn;u("no",g.no),u("extNo",g.extNo),u("operator",g.operator),u("comment",g.comment),u("client",g.client),u("clientCode",g.clientCode),u("incomingNo",g.incomingNo),u("organization",g.organization),u("warehouse",g.warehouse),u("creationDate",g.creationDate),u("warehouseCode",g.warehouse.code),u("supplierCode",g.clientCode),u("organizationCode",g.organization.code),u("shipmentDate",g.shipmentDate)}},[A]);p.useEffect(()=>{U()},[A]);const $=()=>{N(),U(),i(),l()},oe=async g=>{try{n(!0);const _=[],{result:ce,Error:te}=await f(ks(g,e)).unwrap();if(te&&_.push(te),ce=="Ok"){const{AsnLine:V}=await t({AsnId:e}).unwrap();for(let q in g.asnLines){const K=g.asnLines[q];if(V==null?void 0:V.find(w=>w.id===parseInt(q))){const{Error:w}=await T(Ss(K,e,parseInt(q))).unwrap();w&&_.push(w)}else{const{Error:w}=await F(Ee(K,e)).unwrap();w&&_.push(w)}}V==null||V.forEach(async q=>{var Z;if(!((Z=g.asnLines)==null?void 0:Z[q.id])){const{Error:w}=await D({id:q.id}).unwrap();w&&_.push(w)}})}_.length?_.forEach(V=>R(V)):$()}catch{}finally{n(!1)}};return s.jsxDEV(we,{...m,children:s.jsxDEV("form",{onSubmit:v(oe),className:P.form,children:[s.jsxDEV(j,{direction:"column",className:P.innerFormWrapper,children:[s.jsxDEV(ke,{isEditMode:d,isLoading:a},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/Form/Form.tsx",lineNumber:126,columnNumber:11},void 0),s.jsxDEV(Se,{onCancelEditMode:$,asnId:e,isEditMode:d,isLoading:a},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/Form/Form.tsx",lineNumber:127,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/Form/Form.tsx",lineNumber:125,columnNumber:9},void 0),s.jsxDEV(j,{className:P.handles,children:[((re=A==null?void 0:A.Asn)==null?void 0:re.removal)&&!d&&s.jsxDEV(S,{onClick:l,disabled:!!d,label:"Редактировать",type:"button",size:"s"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/Form/Form.tsx",lineNumber:136,columnNumber:13},void 0),!!d&&s.jsxDEV(S,{disabled:!d||!((B=A==null?void 0:A.Asn)!=null&&B.editable),label:"Сохранить",type:"submit",size:"s"},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/Form/Form.tsx",lineNumber:145,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/Form/Form.tsx",lineNumber:134,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/Form/Form.tsx",lineNumber:124,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/Form/Form.tsx",lineNumber:123,columnNumber:5},void 0)},ys=({asn:e})=>s.jsxDEV(De,{modalId:L.EDIT_ASN_MODAL_ID,title:`ASN №${e==null?void 0:e.no} (Статус прихода - ${e==null?void 0:e.incomingState})`,children:e&&s.jsxDEV(Ys,{asnId:e.asnId},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/EditAsn.tsx",lineNumber:15,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/EditAsn/EditAsn.tsx",lineNumber:12,columnNumber:5},void 0),Is=()=>{const a=!!ne(N=>N.modalState).openedIds.find(N=>N===L.DELETE_ASN_MODAL_ID),{asn:n}=ne(N=>N.asnDataState),d=J(),c=()=>d(Pe()),{showToast:l}=ae(),[m,{isLoading:v}]=Q.useDeleteAsnMutation(),u=async()=>{if(n)try{const{Error:N}=await m({AsnId:n.asnId}).unwrap();N?l(N):c()}catch{}};return s.jsxDEV(Ge,{confirmBtnLabel:"Удалить",closeModal:c,onClick:u,title:"Удаление заказа",text:`Вы действительно хотите удалить ASN ${n==null?void 0:n.no}?`,isOpen:a,isLoading:v},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/DeleteAsn/DeleteAsn.tsx",lineNumber:32,columnNumber:5},void 0)},Fs=()=>{const[e,{isLoading:a}]=Q.useUploadAsnMutation(),{showToast:n}=ae(),d=async c=>{try{const l=c[0],m=await Qe(l);if(typeof m=="string"){const{result:v,Error:u}=await e({FileName:l.name,FileBase64:m}).unwrap();v!=null&&n(v,"success"),u&&n(u)}}catch{}};return s.jsxDEV(Me,{modalId:L.IMPORT_ASN,onUpload:d,title:"Загрузить ASN файлом",isLoading:a},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/ImportAsn/ImportAsn.tsx",lineNumber:30,columnNumber:5},void 0)},_s=({asn:e})=>s.jsxDEV(s.Fragment,{children:[s.jsxDEV(Vs,{},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Modals/Modals.tsx",lineNumber:18,columnNumber:7},void 0),s.jsxDEV(ys,{asn:e},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Modals/Modals.tsx",lineNumber:19,columnNumber:7},void 0),s.jsxDEV(Is,{},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Modals/Modals.tsx",lineNumber:20,columnNumber:7},void 0),s.jsxDEV(Je,{title:"Добавить нового Поставщика",modalId:L.ADD_NEW_SUPPLIER,clientType:Ke.supplier},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Modals/Modals.tsx",lineNumber:21,columnNumber:7},void 0),s.jsxDEV(as,{},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Modals/Modals.tsx",lineNumber:26,columnNumber:7},void 0),s.jsxDEV(Fs,{},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Modals/Modals.tsx",lineNumber:27,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/components/Modals/Modals.tsx",lineNumber:17,columnNumber:5},void 0),zs="_main_ursag_1",Os={main:zs},Zs=()=>{const[e,a]=p.useState(null),n=J(),d=l=>n(de(l)),c=l=>{d(L.EDIT_ASN_MODAL_ID),a(l)};return s.jsxDEV(ds,{children:s.jsxDEV(j,{className:Os.main,direction:"column",children:[s.jsxDEV(hs,{onEditAsn:c},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/AsnPage.tsx",lineNumber:27,columnNumber:9},void 0),s.jsxDEV(_s,{asn:e},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/AsnPage.tsx",lineNumber:28,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/AsnPage.tsx",lineNumber:26,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/anatolijcudnov/Desktop/Programming/YP/dev/2004-web/src/pages/AsnPage/AsnPage.tsx",lineNumber:25,columnNumber:5},void 0)};export{Zs as default};
